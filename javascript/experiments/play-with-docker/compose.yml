services:
  redis:
    image: "redis:alpine"
  postgres:
    image: "postgres:15.3"
    ports:
      - '5432:5432'
    volumes:
      - "./data:/var/lib/postgresql/data"
      - "./init.sql:/docker-entrypoint-initdb.d/init.sql"
      - "./populate.sql:/docker-entrypoint-initdb.d/populate.sql"
    environment:
      # Terrible practice, but none cares for this demo.
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: admin
      POSTGRES_DB: db
  one:
    build: ./one
    ports:
      - "3000:3000"
    depends_on:
      - redis
  two:
    build: ./two
    ports:
      - "4000:4000"
    depends_on:
      - one
