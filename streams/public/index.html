<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <div id="root"></div>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
      console.log({ React, ReactDOM });

      // - button that fetches the stream and prints it to the console
      function FetchStream() {
        const [fetching, setFetching] = React.useState(true);

        React.useEffect(() => {
          if (fetching) {
            fetch('/stream')
              .then((res) => res.json())
              .then((data) => {
                console.log(data);
              })
              .catch((err) => {
                console.log(err);
              })
              .finally(() => {
                setFetching(false);
              });
          }
        }, [fetching, setFetching]);

        function fetchStream() {
          setFetching(true);
        }

        return (
          <article>
            <h1>Click the button to fetch the stream</h1>
            <p>
              Trying to figure out how does the fetching work. How can we fetch
              prioritized resources? Can we change the fetched resource?
            </p>
            <button onClick={fetchStream} disabled={fetching}>
              {fetching ? 'Fetching...' : 'Fetch Stream'}
            </button>
          </article>
        );
      }

      ReactDOM.createRoot(document.getElementById('root')).render(
        <FetchStream />
      );
    </script>
  </body>
</html>
